[1mdiff --git a/app/addons/adls_subscriptions/addon.xml b/app/addons/adls_subscriptions/addon.xml[m
[1mindex 73fb823..ae7d132 100644[m
[1m--- a/app/addons/adls_subscriptions/addon.xml[m
[1m+++ b/app/addons/adls_subscriptions/addon.xml[m
[36m@@ -80,7 +80,8 @@[m
         <min>5.4.0</min>[m
     </php_version>[m
 [m
[31m-[m
[32m+[m[32m    <supplier>HELOstore</supplier>[m
[32m+[m[32m    <supplier_link>https://helostore.com/</supplier_link>[m
     <authors>[m
         <author>[m
             <name>HELOstore</name>[m
[1mdiff --git a/app/addons/adls_subscriptions/controllers/backend/adls_plans.php b/app/addons/adls_subscriptions/controllers/backend/adls_plans.php[m
[1mindex 0a6e8bf..ddc4b9d 100644[m
[1m--- a/app/addons/adls_subscriptions/controllers/backend/adls_plans.php[m
[1m+++ b/app/addons/adls_subscriptions/controllers/backend/adls_plans.php[m
[36m@@ -13,6 +13,7 @@[m
  */[m
 [m
 use HeloStore\ADLSS\Plan;[m
[32m+[m[32muse HeloStore\ADLSS\Plan\PlanManager;[m[41m[m
 use HeloStore\ADLSS\Plan\PlanRepository;[m
 use Tygh\Registry;[m
 use Tygh\Tygh;[m
[36m@@ -20,6 +21,7 @@[m [muse Tygh\Tygh;[m
 if (!defined('BOOTSTRAP')) { die('Access denied'); }[m
 [m
 $planRepository = PlanRepository::instance();[m
[32m+[m[32m$planManager = PlanManager::instance();[m[41m[m
 [m
 if (!empty($_REQUEST['id'])) {[m
     $id = $_REQUEST['id'];[m
[36m@@ -72,7 +74,7 @@[m [mif ($_SERVER['REQUEST_METHOD'] == 'POST') {[m
         $suffix = '.manage';[m
 [m
         if (!empty($id)) {[m
[31m-            if ($planRepository->delete($id)) {[m
[32m+[m[32m            if ($planManager->delete($id)) {[m[41m[m
                 fn_set_notification('N', __('notice'), __('adlss.plan.delete.success'));[m
             } else {[m
                 fn_set_notification('E', __('error'), __('adlss.plan.delete.error'));[m
[1mdiff --git a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanManager.php b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanManager.php[m
[1mindex 013872f..23c1117 100644[m
[1m--- a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanManager.php[m
[1m+++ b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanManager.php[m
[36m@@ -16,6 +16,8 @@[m [mnamespace HeloStore\ADLSS\Plan;[m
 [m
 [m
 use HeloStore\ADLSS\Base\Manager;[m
[32m+[m[32muse HeloStore\ADLSS\Plan;[m
[32m+[m[32muse HeloStore\ADLSS\Subscribable\SubscribableRepository;[m
 [m
 class PlanManager extends Manager[m
 {[m
[36m@@ -28,4 +30,23 @@[m [mclass PlanManager extends Manager[m
 	{[m
 		$this->setRepository(PlanRepository::instance());[m
 	}[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * @param Plan $id Plan ID[m
[32m+[m[32m     *[m
[32m+[m[32m     * @return bool|int[m
[32m+[m[32m     */[m
[32m+[m[32m    public function delete($id)[m
[32m+[m[32m    {[m
[32m+[m[32m        $plan = $this->repository->findOneById($id);[m
[32m+[m
[32m+[m[32m        if (empty($plan)) {[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        $subscribableRepository = SubscribableRepository::instance();[m
[32m+[m[32m        $subscribableRepository->deleteByPlanId($plan->getId());[m
[32m+[m
[32m+[m[32m        return $this->repository->delete($plan->getId());[m
[32m+[m[32m    }[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanRepository.php b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanRepository.php[m
[1mindex c3ce5fb..6196fa6 100644[m
[1m--- a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanRepository.php[m
[1m+++ b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Plan/PlanRepository.php[m
[36m@@ -15,6 +15,7 @@[m [mnamespace HeloStore\ADLSS\Plan;[m
 [m
 use HeloStore\ADLSS\Base\EntityRepository;[m
 use HeloStore\ADLSS\Plan;[m
[32m+[m[32muse HeloStore\ADLSS\Subscribable\SubscribableRepository;[m
 use HeloStore\ADLSS\Utils;[m
 [m
 class PlanRepository extends EntityRepository[m
[1mdiff --git a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Subscribable/SubscribableRepository.php b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Subscribable/SubscribableRepository.php[m
[1mindex af43dcb..6735f1e 100644[m
[1m--- a/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Subscribable/SubscribableRepository.php[m
[1m+++ b/app/addons/adls_subscriptions/src/HeloStore/ADLSS/Subscribable/SubscribableRepository.php[m
[36m@@ -90,6 +90,11 @@[m [mclass SubscribableRepository extends EntityRepository[m
 		return db_query('DELETE FROM ?p WHERE objectType = ?s AND objectId = ?d', $this->table, $objectType, $objectId);[m
 	}[m
 [m
[32m+[m[32m    public function deleteByPlanId($planId)[m
[32m+[m[32m    {[m
[32m+[m[32m        return db_query('DELETE FROM ?p WHERE planId = ?i', $this->table, $planId);[m
[32m+[m[32m    }[m
[32m+[m
 	/**[m
 	 * @param array $params[m
 	 *[m
[36m@@ -109,6 +114,10 @@[m [mclass SubscribableRepository extends EntityRepository[m
 				$condition[] = db_quote('objectId IN (?a)', $params['objectId']);[m
 			}[m
 		}[m
[32m+[m[32m        if (!empty($params['planId'])) {[m
[32m+[m[32m            $params['planId'] = is_array($params['planId']) ? $params['planId'] : array($params['planId']);[m
[32m+[m[32m            $condition[] = db_quote('planId IN (?a)', $params['planId']);[m
[32m+[m[32m        }[m
 [m
 		$condition = !empty($condition) ? ' WHERE '. implode(' AND ', $condition) . '' : '';[m
 		$query = db_quote('SELECT * FROM ?p ?p GROUP BY id LIMIT 0,1', $this->table, $condition);[m
warning: LF will be replaced by CRLF in app/addons/adls_subscriptions/addon.xml.
The file will have its original line endings in your working directory.
